
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://phaakma.github.io/kapipy/usage/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../reference/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Usage - kapipy</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#usage-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="kapipy" class="md-header__button md-logo" aria-label="kapipy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            kapipy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Usage
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="brown" data-md-color-accent="yellow"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/phaakma/kapipy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../reference/" class="md-tabs__link">
        
  
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../faq/" class="md-tabs__link">
        
  
  
    
  
  FAQ

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../about/" class="md-tabs__link">
        
  
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="kapipy" class="md-nav__button md-logo" aria-label="kapipy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    kapipy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/phaakma/kapipy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Installation Notes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arcgis" class="md-nav__link">
    <span class="md-ellipsis">
      ArcGIS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jupyter-notebooks" class="md-nav__link">
    <span class="md-ellipsis">
      Jupyter Notebooks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connecting-to-the-various-open-data-portals" class="md-nav__link">
    <span class="md-ellipsis">
      Connecting to the various open data portals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-a-reference-to-an-item" class="md-nav__link">
    <span class="md-ellipsis">
      Get a reference to an item
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wfs-queries" class="md-nav__link">
    <span class="md-ellipsis">
      WFS queries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WFS queries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query" class="md-nav__link">
    <span class="md-ellipsis">
      Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changeset" class="md-nav__link">
    <span class="md-ellipsis">
      Changeset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-with-a-spatial-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Query with a spatial filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-using-a-spatial-filter-extent-bbox" class="md-nav__link">
    <span class="md-ellipsis">
      Query using a spatial filter extent - bbox
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#export-data" class="md-nav__link">
    <span class="md-ellipsis">
      Export data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Export data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#export-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Export formats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-item-export" class="md-nav__link">
    <span class="md-ellipsis">
      Single item export
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-an-export-using-a-spatial-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Generate an export using a spatial filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-and-download-multiple-items" class="md-nav__link">
    <span class="md-ellipsis">
      Export and download multiple items
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audit-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Audit Manager
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Installation Notes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arcgis" class="md-nav__link">
    <span class="md-ellipsis">
      ArcGIS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jupyter-notebooks" class="md-nav__link">
    <span class="md-ellipsis">
      Jupyter Notebooks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connecting-to-the-various-open-data-portals" class="md-nav__link">
    <span class="md-ellipsis">
      Connecting to the various open data portals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-a-reference-to-an-item" class="md-nav__link">
    <span class="md-ellipsis">
      Get a reference to an item
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wfs-queries" class="md-nav__link">
    <span class="md-ellipsis">
      WFS queries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WFS queries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query" class="md-nav__link">
    <span class="md-ellipsis">
      Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changeset" class="md-nav__link">
    <span class="md-ellipsis">
      Changeset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-with-a-spatial-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Query with a spatial filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-using-a-spatial-filter-extent-bbox" class="md-nav__link">
    <span class="md-ellipsis">
      Query using a spatial filter extent - bbox
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#export-data" class="md-nav__link">
    <span class="md-ellipsis">
      Export data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Export data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#export-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Export formats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#single-item-export" class="md-nav__link">
    <span class="md-ellipsis">
      Single item export
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-an-export-using-a-spatial-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Generate an export using a spatial filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-and-download-multiple-items" class="md-nav__link">
    <span class="md-ellipsis">
      Export and download multiple items
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audit-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Audit Manager
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="usage-guide">Usage Guide<a class="headerlink" href="#usage-guide" title="Permanent link">&para;</a></h1>
<p>This guide walks you through the main ways to use the <code>kapipy</code> package to query and download data from the LINZ Data Service via Koordinates.</p>
<h2 id="installation-notes">Installation Notes<a class="headerlink" href="#installation-notes" title="Permanent link">&para;</a></h2>
<p>Kapipy is designed to use either GeoPandas or the ArcGIS API for Python, returning and reading data as either a GeoDataFrame or a Spatially Enabled DataFrame respectively.  Neither package is defined as a requirement of kapipy, as users may choose to use one over the other and may not want the other automatically installed.  </p>
<p>This means you need to manually install one of either <strong>geopandas</strong> or <strong>arcgis</strong> into your Python environment.</p>
<h3 id="arcgis">ArcGIS<a class="headerlink" href="#arcgis" title="Permanent link">&para;</a></h3>
<p>If you are an ArcGIS user, cloning the default conda environment from ArcGIS Pro or ArcGIS Server should be sufficient, and you just need to install kapipy. If you choose to start with a blank environment and do not intend to install arcpy, you may need to install the following:<br />
- pyproj<br />
- shapely<br />
- pyshp  </p>
<h3 id="jupyter-notebooks">Jupyter Notebooks<a class="headerlink" href="#jupyter-notebooks" title="Permanent link">&para;</a></h3>
<p>If you are starting with a clean Python environment and want to use Jupyter Notebooks (e.g. inside Visual Studio Code), then manually install these packages:<br />
- ipykernel<br />
- ptyprocess<br />
- comm  </p>
<h2 id="connecting-to-the-various-open-data-portals">Connecting to the various open data portals<a class="headerlink" href="#connecting-to-the-various-open-data-portals" title="Permanent link">&para;</a></h2>
<p>LINZ, Stats NZ and LRIS have built in names for convenience. Alternatively, pass in the base URL.  </p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kapipy.gis</span><span class="w"> </span><span class="kn">import</span> <span class="n">GISK</span>

<span class="n">linz</span> <span class="o">=</span> <span class="n">GISK</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;linz&quot;</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;your-linz-api-key&quot;</span><span class="p">)</span>
<span class="n">statsnz</span> <span class="o">=</span> <span class="n">GISK</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;statsnz&#39;</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;your-stats-api-key&quot;</span><span class="p">)</span>
<span class="n">lris</span> <span class="o">=</span> <span class="n">GISK</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;lris&#39;</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;your-lris-api-key&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Passing in a base url:  </p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kapipy.gis</span><span class="w"> </span><span class="kn">import</span> <span class="n">GIS</span>

<span class="n">linz</span> <span class="o">=</span> <span class="n">GISK</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://data.linz.govt.nz/&quot;</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;your-linz-api-key&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="get-a-reference-to-an-item">Get a reference to an item<a class="headerlink" href="#get-a-reference-to-an-item" title="Permanent link">&para;</a></h2>
<p>The gis object has a property called <strong>content</strong> which is a ContentManager. This allows you to get a reference to an item using it's id.  </p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kapipy.gis</span><span class="w"> </span><span class="kn">import</span> <span class="n">GISK</span>

<span class="c1">#create gis object</span>
<span class="n">linz</span> <span class="o">=</span> <span class="n">GISK</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;linz&quot;</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;your-linz-api-key&quot;</span><span class="p">)</span>

<span class="c1">#get item object</span>
<span class="n">rail_station_layer_id</span> <span class="o">=</span> <span class="s2">&quot;50318&quot;</span> <span class="c1">#rail station 175 points</span>
<span class="n">itm</span> <span class="o">=</span> <span class="n">linz</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rail_station_layer_id</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">itm</span><span class="p">)</span>
</code></pre></div>

<h2 id="wfs-queries">WFS queries<a class="headerlink" href="#wfs-queries" title="Permanent link">&para;</a></h2>
<p>Items with WFS endpoints can be queried using the <strong>query</strong> and, if the item supports changesets, <strong>changeset</strong> methods of the item .</p>
<p>For spatial items, it is recommended to specify a desired spatial reference via the <strong>out_sr</strong> parameter.  </p>
<h3 id="query">Query<a class="headerlink" href="#query" title="Permanent link">&para;</a></h3>
<p>Get all data  </p>
<div class="codehilite"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">itm</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">)</span>
</code></pre></div>

<p>Get first 5 records.  </p>
<div class="codehilite"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">itm</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">result_record_count</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">)</span>
</code></pre></div>

<p>Data is returned as a WFSResponse object. This has four attributes that can be used to access the data:<br />
- <strong>.json</strong>: this provides the raw json response returned from the WFS service.<br />
- <strong>.df</strong>: this provides a Pandas DataFrame of the data.<br />
- <strong>.gdf</strong>: if geopandas is installed, this will return a GeoDataFrame of the data.<br />
- <strong>.sdf</strong>: if arcgis is installed, this will return a Spatially Enabled DataFrame of the data.  </p>
<p>The attribute types of the dataframes are set according to the item's field list.  </p>
<div class="codehilite"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sdf</span><span class="o">.</span><span class="n">dtypes</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sdf</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</code></pre></div>

<p>Only fetch specified attribute fields. Remember to include the geometry field if you want that in the tabular data.  </p>
<div class="codehilite"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">itm</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="n">out_fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;geodetic_code&#39;</span><span class="p">,</span> <span class="n">itm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">geometry_field</span><span class="p">],</span>
    <span class="n">out_sr</span> <span class="o">=</span> <span class="mi">2193</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total records returned </span><span class="si">{</span><span class="n">itm</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>

<h3 id="changeset">Changeset<a class="headerlink" href="#changeset" title="Permanent link">&para;</a></h3>
<p>Also returned as a WFSResponse object with the same logic as the <strong>query</strong> method.<br />
The datetime parameters should be provided in ISO 8601 format.  </p>
<p>The <strong>from_time</strong> parameter is the time from which the changeset data will be generated.<br />
The <strong>to_time</strong> parameter is optional, and is the time up to which the changeset data will be generated. If this parameter is not provided then it defaults to now.  </p>
<div class="codehilite"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">itm</span><span class="o">.</span><span class="n">changeset</span><span class="p">(</span><span class="n">from_time</span><span class="o">=</span><span class="s2">&quot;2024-01-01T00:00:00Z&quot;</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="sa">f</span><span class="s2">&quot;Total records returned </span><span class="si">{</span><span class="n">itm</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">gdf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</code></pre></div>

<h3 id="query-with-a-spatial-filter">Query with a spatial filter<a class="headerlink" href="#query-with-a-spatial-filter" title="Permanent link">&para;</a></h3>
<p>The <strong>filter_geometry</strong> argument can be passed in as a gdf or sdf.  </p>
<p>It is recommended to only have one polygon geometry in the dataframe, and avoid complex geometries with lots of vertices. If your use case requires a complex polygon geometry that the API can't handle, consider making the query using the bbox extent and then doing a local intersect on the data afterwards to drop the features you don't want.   </p>
<p>If there is more than one record in the dataframe, the records will be unioned into one geometry. The more records, the longer this will take which is why it is recommended to only have one record or at least minimise the number.    </p>
<p>The following example will only return features that intersect the <strong>filter_geometry</strong> object.  </p>
<div class="codehilite"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">itm</span><span class="o">.</span><span class="n">changeset</span><span class="p">(</span>
    <span class="n">from_time</span><span class="o">=</span><span class="s2">&quot;2024-01-01T00:00:00Z&quot;</span><span class="p">,</span> 
    <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">,</span>
    <span class="n">filter_geometry</span><span class="o">=</span><span class="n">matamata_gdf</span>
    <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total records returned </span><span class="si">{</span><span class="n">itm</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">sdf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">sdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>

<h3 id="query-using-a-spatial-filter-extent-bbox">Query using a spatial filter extent - bbox<a class="headerlink" href="#query-using-a-spatial-filter-extent-bbox" title="Permanent link">&para;</a></h3>
<p>The <strong>bbox_geometry</strong> argument can be passed in as a gdf or sdf.  </p>
<p>If there is more than one record in the dataframe, the extent of all geometries is calculated. The more records, the longer this will take which is why it is recommended to only have one record or at least minimise the number.     </p>
<p>The following example will only return features that intersect the bounding box extent of the <strong>bbox_geometry</strong> object.  </p>
<div class="codehilite"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">itm</span><span class="o">.</span><span class="n">changeset</span><span class="p">(</span>
    <span class="n">from_time</span><span class="o">=</span><span class="s2">&quot;2024-01-01T00:00:00Z&quot;</span><span class="p">,</span> 
    <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">,</span>
    <span class="n">bbox_geometry</span><span class="o">=</span><span class="n">matamata_gdf</span>
    <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total records returned </span><span class="si">{</span><span class="n">itm</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">sdf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">sdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>

<h2 id="export-data">Export data<a class="headerlink" href="#export-data" title="Permanent link">&para;</a></h2>
<p>Exporting data creates an asynchronous task on the data portal server that returns a job id. It is possible to create and manage individual downloads, or treat them collectively.  </p>
<p>Again, it is recommended to always specify the <strong>out_sr</strong>.  </p>
<h3 id="export-formats">Export formats<a class="headerlink" href="#export-formats" title="Permanent link">&para;</a></h3>
<p>You can check the available export formats by using the <strong>data.export_formats</strong> property of an item.  </p>
<div class="codehilite"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">itm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">export_formats</span><span class="p">)</span>
</code></pre></div>

<h3 id="single-item-export">Single item export<a class="headerlink" href="#single-item-export" title="Permanent link">&para;</a></h3>
<p>The item <strong>export</strong> method initiates the creation of the job on the server and a <strong>JobResult</strong> object is returned. Accessing the <strong>status</strong> property triggers a check with the server to get the latest <strong>status</strong> of the job.<br />
The <strong>status</strong> returned is a <strong>JobStatus</strong> object that has <strong>state</strong> and <strong>progress</strong> properties.  </p>
<div class="codehilite"><pre><span></span><code><span class="n">job</span> <span class="o">=</span> <span class="n">itm</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;geodatabase&quot;</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
</code></pre></div>

<p>Download the job data once it is ready. If this method is called before the job <strong>state</strong> is <strong>'complete'</strong>, it will poll the status of the job until it is ready and then downloads it.<br />
Calling the download method of a JobResult object gives you the flexibility of specifying a specific folder for that download.  </p>
<div class="codehilite"><pre><span></span><code><span class="n">job</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;c:/temp&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="generate-an-export-using-a-spatial-filter">Generate an export using a spatial filter<a class="headerlink" href="#generate-an-export-using-a-spatial-filter" title="Permanent link">&para;</a></h3>
<p>The <strong>filter_geometry</strong> argument can be passed in as a gdf, sdf or geojson.  </p>
<p>It is recommended to only have one polygon geometry in the dataframe, and avoid complex geometries with lots of vertices. If there is more than one record in the dataframe, the records will be unioned into one geometry.  </p>
<p>The following example will only return features that intersect the <strong>filter_geometry</strong> object.  </p>
<div class="codehilite"><pre><span></span><code><span class="c1"># gdf</span>
<span class="n">matamata_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;../examples/matamata_piako.shp&quot;</span><span class="p">)</span>
<span class="c1"># sdf</span>
<span class="n">matamata_sdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">from_featureclass</span><span class="p">(</span><span class="s2">&quot;../examples/matamata_piako.shp&quot;</span><span class="p">)</span>

<span class="n">job</span> <span class="o">=</span> <span class="n">itm</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;geodatabase&quot;</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">,</span> <span class="n">filter_geometry</span><span class="o">=</span><span class="n">matamata_sdf</span><span class="p">,)</span>
</code></pre></div>

<h3 id="export-and-download-multiple-items">Export and download multiple items<a class="headerlink" href="#export-and-download-multiple-items" title="Permanent link">&para;</a></h3>
<p>Whenever the <strong>export</strong> method of an item is called, the <strong>JobResult</strong> object is added to a list belonging to the ContentManager called <strong>jobs</strong>. </p>
<p>The ContentManager has a download method as well. Calling this method and passing in a folder will download to that folder any jobs in the content manager's job list that are not already downloaded.  </p>
<p><strong>NOTE</strong> The download method of the ContentManager has no concept of a timeout period. It will just keep polling every job until they either finish or error.  </p>
<div class="codehilite"><pre><span></span><code><span class="n">itm1</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;geodatabase&quot;</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">matamata_sdf</span><span class="p">,)</span>
<span class="n">itm2</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;geodatabase&quot;</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">matamata_sdf</span><span class="p">,)</span>

<span class="n">linz</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;c:/temp&quot;</span><span class="p">)</span>
</code></pre></div>

<p>The ContentManager also has a <strong>download_folder</strong> property. You can set this and it will be used as the default if no folder is provided.  </p>
<div class="codehilite"><pre><span></span><code><span class="n">linz</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">download_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;c:/temp&quot;</span>

<span class="n">itm1</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;geodatabase&quot;</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">matamata_sdf</span><span class="p">,)</span>
<span class="n">itm2</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;geodatabase&quot;</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">matamata_sdf</span><span class="p">,)</span>

<span class="n">linz</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>
</code></pre></div>

<p>Alternatively, you can pass the content manager's <strong>download</strong> method a list of specific jobs and only those jobs will be downloaded.  </p>
<div class="codehilite"><pre><span></span><code><span class="n">job_1</span> <span class="o">=</span> <span class="n">itm1</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;geodatabase&quot;</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">matamata_sdf</span><span class="p">,)</span>
<span class="n">job_2</span> <span class="o">=</span> <span class="n">itm2</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;geodatabase&quot;</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">matamata_sdf</span><span class="p">,)</span>
<span class="n">job_3</span> <span class="o">=</span> <span class="n">itm3</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;geodatabase&quot;</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">matamata_sdf</span><span class="p">,)</span>
<span class="n">job_4</span> <span class="o">=</span> <span class="n">itm4</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;geodatabase&quot;</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">matamata_sdf</span><span class="p">,)</span>
<span class="n">job_5</span> <span class="o">=</span> <span class="n">itm5</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;geodatabase&quot;</span><span class="p">,</span> <span class="n">out_sr</span><span class="o">=</span><span class="mi">2193</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">matamata_sdf</span><span class="p">,)</span>

<span class="c1"># only jobs 1, 3 and 5 will be downloaded</span>
<span class="n">linz</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">download</span><span class="p">([</span><span class="n">job_1</span><span class="p">,</span> <span class="n">job_3</span><span class="p">,</span> <span class="n">job_5</span><span class="p">])</span>
</code></pre></div>

<p>Once a job is downloaded, it's "downloaded" attribute will be set to True, and any future calls to the ContentManager's <strong>download</strong> method will not download it.<br />
Use the 'force_all' parameter to force a download of all jobs in the list, regardless of their download status.  </p>
<div class="codehilite"><pre><span></span><code><span class="n">linz</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">force_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<p>You can iterate over the jobs.  </p>
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">linz</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">download_file_path</span><span class="p">)</span>
</code></pre></div>

<h2 id="audit-manager">Audit Manager<a class="headerlink" href="#audit-manager" title="Permanent link">&para;</a></h2>
<p>The Audit Manager is optional. If enabled, it:<br />
- Records details of every query and export in a sqlite database.<br />
- Saves a copy of every query response as a file.  </p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kapipy.gis</span><span class="w"> </span><span class="kn">import</span> <span class="n">GISK</span>

<span class="c1"># create gis object</span>
<span class="n">linz</span> <span class="o">=</span> <span class="n">GISK</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;linz&quot;</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;your-linz-api-key&quot;</span><span class="p">)</span>

<span class="c1"># enable audit logging</span>
<span class="n">linz</span><span class="o">.</span><span class="n">audit</span><span class="o">.</span><span class="n">enable_auditing</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;c:/temp/audit&quot;</span><span class="p">)</span>

<span class="c1"># get item object</span>
<span class="n">rail_station_layer_id</span> <span class="o">=</span> <span class="s2">&quot;50318&quot;</span> <span class="c1">#rail station 175 points</span>
<span class="n">itm</span> <span class="o">=</span> <span class="n">linz</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rail_station_layer_id</span><span class="p">)</span>

<span class="c1"># Any query will now automatically populate a record in the audit database</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">itm</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
</code></pre></div>

<p>A copy of each response is saved as a json file. You can optionally disable this by passing in retain_data=False when enabling the audit manager.  </p>
<div class="codehilite"><pre><span></span><code><span class="n">linz</span><span class="o">.</span><span class="n">audit</span><span class="o">.</span><span class="n">enable_auditing</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;c:/temp/audit&quot;</span><span class="p">,</span> <span class="n">retain_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

<p>The Audit Manager does not perform any clean up actions. You may wish to periodically purge old records from the sqlite database and/or the json files.  </p>
<p>The .export() method does not record the total_features count. This is because the data is returned as a zip file in any one of several formats, and to compute the counts would require the overhead of unzipping, handling reading in any format then computing the actual counts. Doing this, for example, on the NZ Parcels layer with ~2.7 million records is non-trivial and therefore not undertaken.  </p>
<p>The most recent record for a given id can be retrieved.  </p>
<div class="codehilite"><pre><span></span><code><span class="c1"># returns record of the most recent query recorded.  </span>
<span class="n">latest</span> <span class="o">=</span> <span class="n">linz</span><span class="o">.</span><span class="n">audit</span><span class="o">.</span><span class="n">get_latest_request_for_item</span><span class="p">(</span><span class="n">rail_station_layer_id</span><span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.instant", "content.code.copy", "search.highlight", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>